(function(e){function t(t){for(var r,l,n=t[0],o=t[1],c=t[2],m=0,d=[];m<n.length;m++)l=n[m],s[l]&&d.push(s[l][0]),s[l]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,n=1;n<a.length;n++){var o=a[n];0!==s[o]&&(r=!1)}r&&(i.splice(t--,1),e=l(l.s=a[0]))}return e}var r={},s={"personal-set":0},i=[];function l(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(){return Promise.resolve()},l.m=e,l.c=r,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(a,r,function(t){return e[t]}.bind(null,r));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],o=n.push.bind(n);n.push=t,n=n.slice();for(var c=0;c<n.length;c++)t(n[c]);var u=o;i.push([19,"chunk-vendors","chunk-common"]),a()})({1282:function(e,t,a){"use strict";(function(e){var r=a("8af6");t["a"]={name:"app",mounted(){this.loadData()},components:{Header:r["a"]},methods:{loadData(){let t=this;this.$http.post("/user/queryuserinfo",{},a=>{a.success&&(null!=a.data.userSex&&void 0!==a.data.userSex&&""!==a.data.userSex||(a.data.userSex="0"),e.extend(t.form,a.data),null!==a.data.userEnterYear&&t.$http.post("/user/queryclass",{userEnterYear:a.data.userEnterYear},e=>{t.classData=e.data}))});let a=[],r=(new Date).getFullYear();for(let e=0;e<10;e++)a.push(r-e);this.enterYearData=a},changeEnterYear(){let e=this;e.form.userClassId="",this.$http.post("/user/queryclass",{userEnterYear:this.form.userEnterYear},t=>{t.success&&(e.classData=t.data)})},changeNickNameFlg(){this.nickNameEditFlg=!this.nickNameEditFlg},saveNickName(){let e=this;if(""===e.nickNameEdit)return this.$alert("修改昵称不能为空！","提示",{confirmButtonText:"确定"}),!1;e.$http.post("/user/modifynickname",{token:localStorage.getItem("token"),userNickname:e.nickNameEdit},t=>{if(t.success){e.nickNameEditFlg=!1,e.form.userNickname=e.nickNameEdit;var a=new FormData;a.append("snsNo",localStorage.getItem("snsNo")),a.append("nickName",e.nickNameEdit),e.$http.snspost("/member/lyingEditMemberNkNm",a,t=>{e.$alert("保存成功！","提示",{confirmButtonText:"确定"}),e.nickNameEditFlg=!1,e.form.userNickname=e.nickNameEdit})}})},changeEditImgStatus(e){this.editImgFlg="img"!==e||!this.editImgFlg},uploadPhoto(e){let t=this,a=e.target.files[0],r=a.size;if(r>=3145728)return t.$alert("图片大小不能超过3MB！","提示",{confirmButtonText:"确定"}),!1;t.valWidthAndHeight(a).then(function(e){if(e){let e=new FormData;e.append("file",a),t.$http.uploadFile("/user/uploadimg",e,e=>{let a=e.data;if(e.success){t.form.userPhotoUrl=a;var r=new FormData;r.append("snsNo",localStorage.getItem("snsNo")),r.append("avatar",a),t.$http.snspost("/member/lyinguploadavatar",r,e=>{t.form.userPhotoUrl=a,t.$alert("上传成功！","提示",{confirmButtonText:"确定"})})}})}})},valWidthAndHeight:function(e){return new Promise(function(t,a){let r=window.URL||window.webkitURL,s=new Image;s.src=r.createObjectURL(e),s.onload=function(){let e=s.width/s.height===1;e?t():a()}}).then(()=>{return!0},()=>{return this.$alert("上传图片尺寸不符合,只能是1:1!","提示",{confirmButtonText:"确定"}),!1})},save(e){let t=this;this.$refs[e].validate(e=>{if(!e)return console.log("error submit!!"),!1;t.$http.post("/user/modifybasicinfo",t.form,e=>{if(e.success){let e="男";"1"===t.form.userSex&&(e="女");var a=new FormData;a.append("id",localStorage.getItem("snsNo")),a.append("name",t.form.userRealname),a.append("sex",e),a.append("introduce",""),t.$http.snspost("/member/editLyingBaseInfo",a,e=>{t.$alert("保存成功！","提示",{confirmButtonText:"确定"}).then(({value:e})=>{window.location="personal-main.html"})})}})})}},data(){var e=(e,t,a)=>{this.form.qq=t.replace(/[^\d]/g,""),a()},t=(e,t,a)=>{""===t||null===t?a():(this.form.userStudentNumber=t.replace(/[^\d]/g,""),a())},a=(e,t,a)=>{""!==t&&null!==t||a(new Error("请输入姓名"));var r=/^[\u4E00-\u9FA5\uf900-\ufa2d·s]{2,20}$/;r.test(t)?a():a(new Error("姓名格式不正确"))};return{avatar:"https://gss0.bdstatic.com/-4o3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike92%2C5%2C5%2C92%2C30/sign=62d46c39067b020818c437b303b099b6/d4628535e5dde7119c3d076aabefce1b9c1661ba.jpg",classData:[],enterYearData:[],editImgFlg:!1,nickNameEditFlg:!1,nickNameEdit:"",form:{userNickname:"",userSex:"1",userEmail:"",userRealname:"",userStudentNumber:"",schoolName:"",facultyName:"",majorName:"",userClassId:"",userEnterYear:"",userPhotoUrl:"",qq:""},validWidth:1024,validHeight:1024,rules:{userRealname:[{required:!0,message:"请输入姓名",trigger:"blur"},{validator:a,trigger:"blur"},{validator:a,trigger:"change"}],userSex:[{required:!0,message:"请选择性别",trigger:"blur"}],userEmail:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"},{min:5,max:20,message:"邮箱格式不正确",trigger:"blur"}],username:[{required:!0,message:"请输入姓名",trigger:"blur"}],userClassId:[{required:!0,message:"请选择班级",trigger:"blur"}],userEnterYear:[{required:!0,message:"请选择入学年份",trigger:"blur"}],userStudentNumber:[{validator:t,trigger:"blur"}],qq:[{required:!0,message:"请输入QQ号",trigger:"blur"},{min:5,max:11,message:"QQ号格式不正确",trigger:"blur"},{validator:e,trigger:"change"}]}}}}}).call(this,a("1157"))},19:function(e,t,a){e.exports=a("c90c")},"1b2b":function(e,t,a){"use strict";var r=a("4367"),s=a.n(r);s.a},4367:function(e,t,a){},be36:function(e,t,a){"use strict";var r=a("e817"),s=a.n(r);s.a},c90c:function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("Header",{attrs:{img:"",school:"Go语言实战抽奖系统"}}),a("div",{staticClass:"container-fluid"},[a("hr",{staticStyle:{border:"none"}}),a("div",{staticClass:"row",staticStyle:{"margin-bottom":"40px"}},[a("div",{staticClass:"col-2 col-md-offset-1 navigation"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12 text-center"},[a("div",{staticClass:"rank-img mt-4",style:{backgroundImage:"url("+e.form.userPhotoUrl+")"}},[a("div",{staticClass:"rank-user",on:{click:function(t){return e.$refs.headPortrait.click()}}},[e._v("修改头像")]),a("input",{ref:"headPortrait",staticStyle:{display:"none"},attrs:{type:"file",name:"fileUpload",accept:"image/*"},on:{change:function(t){return e.uploadPhoto(t)}}})])]),e.editImgFlg?a("span",{staticClass:"edit-img",on:{mouseover:function(t){return e.changeEditImgStatus("span")},mouseout:function(t){return e.changeEditImgStatus("span")}}},[e._v("修改头像")]):e._e(),e.nickNameEditFlg?e._e():a("div",{staticClass:"col-12 text-center",staticStyle:{height:"50px","margin-top":"25px"}},[null===e.form.userNickname?a("span",{staticClass:"nick-name"},[e._v("请设置昵称")]):a("span",{staticClass:"nick-name"},[e._v(e._s(e.form.userNickname))]),a("a",{staticClass:"edit",on:{click:e.changeNickNameFlg}},[e._v("修改")])]),e.nickNameEditFlg?a("div",{staticClass:"col-12 text-center",staticStyle:{height:"50px","margin-top":"25px"}},[a("div",{staticClass:"col-md-12 text-center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.nickNameEdit,expression:"nickNameEdit"}],staticClass:"nick-name el-input__inner",staticStyle:{width:"80px!important",height:"25px!important"},attrs:{maxlength:"6",type:"text"},domProps:{value:e.nickNameEdit},on:{input:function(t){t.target.composing||(e.nickNameEdit=t.target.value)}}})]),a("div",{staticClass:"col-md-12 text-center"},[a("a",{staticClass:"edit",staticStyle:{"margin-left":"0px"},on:{click:function(t){return e.saveNickName()}}},[e._v("保存")]),a("a",{staticClass:"edit",staticStyle:{color:"rgba(153,153,153,1)!important"},on:{click:e.changeNickNameFlg}},[e._v("取消")])])]):e._e()]),e._m(0)]),a("div",{staticClass:"col-8  person-detail"},[e._m(1),a("div",{staticClass:"row",staticStyle:{"padding-left":"38px","margin-top":"20px"}},[a("h4",{staticClass:"ml-5 xinxi-title"},[e._v("基本信息")]),a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[a("div",{staticClass:"row mr-3 mt-5"},[a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"姓名",prop:"userRealname"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.userRealname,callback:function(t){e.$set(e.form,"userRealname",t)},expression:"form.userRealname"}})],1),a("el-form-item",{attrs:{label:"性别",prop:"userSex"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.userSex,callback:function(t){e.$set(e.form,"userSex",t)},expression:"form.userSex"}},[e._v("男")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.userSex,callback:function(t){e.$set(e.form,"userSex",t)},expression:"form.userSex"}},[e._v("女")])],1),a("el-form-item",{attrs:{label:"QQ",prop:"qq"}},[a("el-input",{attrs:{placeholder:"请输入QQ"},model:{value:e.form.qq,callback:function(t){e.$set(e.form,"qq",t)},expression:"form.qq"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"userEmail"}},[a("el-input",{attrs:{placeholder:"请输入邮箱地址"},model:{value:e.form.userEmail,callback:function(t){e.$set(e.form,"userEmail",t)},expression:"form.userEmail"}})],1)],1)]),a("h4",{staticClass:"ml-5 xinxi-title"},[e._v("校园信息")]),a("div",{staticClass:"row mt-5 mr-3"},[a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"入学时间",prop:"userEnterYear"}},[a("el-select",{attrs:{placeholder:"请选择入学时间"},on:{change:e.changeEnterYear},model:{value:e.form.userEnterYear,callback:function(t){e.$set(e.form,"userEnterYear",t)},expression:"form.userEnterYear"}},e._l(e.enterYearData,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"学校"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.schoolName,callback:function(t){e.$set(e.form,"schoolName",t)},expression:"form.schoolName"}})],1)],1)]),a("div",{staticClass:"row mr-3"},[a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"班级",prop:"userClassId"}},[a("el-select",{attrs:{placeholder:"请选择班级"},model:{value:e.form.userClassId,callback:function(t){e.$set(e.form,"userClassId",t)},expression:"form.userClassId"}},e._l(e.classData,function(e){return a("el-option",{key:e.classId,attrs:{label:e.className,value:e.classId}})}),1)],1)],1),a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"学院/系"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.facultyName,callback:function(t){e.$set(e.form,"facultyName",t)},expression:"form.facultyName"}})],1)],1)]),a("div",{staticClass:"row mr-3"},[a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"学号",prop:"userStudentNumber"}},[a("el-input",{attrs:{placeholder:"请输入学号",maxlength:"16"},model:{value:e.form.userStudentNumber,callback:function(t){e.$set(e.form,"userStudentNumber",t)},expression:"form.userStudentNumber"}})],1)],1),a("div",{staticClass:"col-6"},[a("el-form-item",{attrs:{label:"专业"}},[a("el-input",{attrs:{disabled:!0},model:{value:e.form.majorName,callback:function(t){e.$set(e.form,"majorName",t)},expression:"form.majorName"}})],1)],1)]),a("div",{staticClass:"row mt-4"},[a("a",{staticClass:"center-block btn save-btn",staticStyle:{"padding-top":"12px",color:"white"},on:{click:function(t){return e.save("form")}}},[e._v("保存")])])])],1)])])])],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row",staticStyle:{"border-top":"1px solid #EBEBEB"}},[a("div",{staticClass:" text-center",staticStyle:{height:"56px","line-height":"56px",background:"rgba(248,248,248,1)"}},[a("div",{staticStyle:{height:"33px",width:"4px",background:"#6612CF",float:"left","margin-top":"10px","border-radius":"2px"}}),a("span",[e._v("个人资料")])]),a("div",{staticClass:"col-12 text-center",staticStyle:{height:"56px","line-height":"56px"}},[a("a",{staticStyle:{color:"#333333"},attrs:{href:"personal-management.html"}},[e._v("账户管理")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"border-bottom":"1px solid #EBEBEB",padding:"unset",height:"56px","line-height":"56px"}},[a("span",{staticClass:"detail-title"},[e._v("个人资料")])])}],l=a("1282"),n=l["a"],o=(a("1b2b"),a("be36"),a("2877")),c=Object(o["a"])(n,s,i,!1,null,"892edcd0",null),u=c.exports,m=(a("7378"),a("3a10"),a("49f4"),a("87c5"),a("751a"));r["default"].prototype.$http=m["a"],new r["default"]({render:e=>e(u)}).$mount("#app")},e817:function(e,t,a){}});
//# sourceMappingURL=personal-set.bac3ee5f.js.map