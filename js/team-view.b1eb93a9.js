(function(t){function e(e){for(var o,i,l=e[0],s=e[1],m=e[2],u=0,d=[];u<l.length;u++)i=l[u],n[i]&&d.push(n[i][0]),n[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);c&&c(e);while(d.length)d.shift()();return r.push.apply(r,m||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],o=!0,l=1;l<a.length;l++){var s=a[l];0!==n[s]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var o={},n={"team-view":0},r=[];function i(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(){return Promise.resolve()},i.m=t,i.c=o,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(a,o,function(e){return t[e]}.bind(null,o));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=e,l=l.slice();for(var m=0;m<l.length;m++)e(l[m]);var c=s;r.push([38,"chunk-vendors","chunk-common"]),a()})({"319f":function(t,e,a){},38:function(t,e,a){t.exports=a("8e93")},"8a0e":function(t,e,a){"use strict";var o=a("319f"),n=a.n(o);n.a},"8e93":function(t,e,a){"use strict";a.r(e);var o=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"container-fluid",staticStyle:{padding:"unset"}},[a("Header",{attrs:{school:"东北大学"}}),a("ProjectTitle",{attrs:{data:t.projectInfo}}),a("TeamTab",{staticStyle:{display:"none"},attrs:{data:t.tabData,"active-index":1}}),a("div",{staticClass:"container"},[a("div",{staticClass:"bar"},[a("div",{staticClass:"title"},[t._v(t._s(t.teamInfo.teamName))]),a("el-form",{staticClass:"demo-form-inline pull-right",attrs:{inline:!0}},[a("el-form-item",[a("span",[t._v(" 当前人数 ")]),a("span",[t._v(t._s(t.teamInfo.currentMemberCount)+"人")]),a("span",[t._v(" 申请人数 ")]),a("span",[t._v(t._s(t.teamInfo.applyMemberCount)+"人")])]),a("el-form-item",[-1===t.myJoinType?a("div",[1!==t.myJoinStatus?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.applyJoin(t.teamInfo.teamId)}}},[t._v("申请加入")]):a("el-button",[t._v("已申请")])],1):t._e(),1===t.myJoinType&&0===t.myJoinStatus?a("div",[a("el-button",[t._v("已申请")])],1):t._e(),0===t.myJoinType?a("div",[0===t.myJoinStatus?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleInvite(t.teamInfo.teamId,1)}}},[t._v("同意")]):t._e(),0===t.myJoinStatus?a("el-button",{on:{click:function(e){return t.handleInvite(t.teamInfo.teamId,-1)}}},[t._v("拒绝")]):t._e()],1):t._e()]),1===t.myJoinStatus?a("el-form-item",[a("el-button",{on:{click:t.deleteMe}},[t._v("退出")])],1):t._e(),-1===t.myJoinStatus&&1===t.myJoinType||-1===t.myJoinType||0===t.myJoinStatus&&1===t.myJoinType||-1===t.myJoinStatus&&0===t.myJoinType?a("el-form-item",[a("el-button",{on:{click:t.goBack}},[t._v("返回")])],1):t._e()],1)],1),a("div",{staticClass:"main"},[a("div",{staticClass:"member-list"},t._l(t.teamInfo.memberList,function(e){return a("div",{key:e.userCode,staticClass:"box member-box"},[a("div",{staticClass:"name"},[t._v(t._s(e.userName))]),a("div",{staticClass:"position"},[t._v(t._s("leader"===e.teamRole?"队长":"队员"))]),a("div",{staticClass:"head-portrait"})])}),0)])])],1),a("el-dialog",{attrs:{title:"创建团队",visible:t.createTeamDialogVisible,width:"468px",center:""},on:{"update:visible":function(e){t.createTeamDialogVisible=e}}},[a("div",{staticClass:"content"},[a("el-form",{ref:"createTeamForm",attrs:{model:t.createTeamForm,"label-width":"90px"}},[a("div",{staticClass:"head-portrait",style:{backgroundImage:"url("+t.createTeamForm.logoUrl+")"}},[a("div",{staticClass:"model",on:{click:function(e){return t.$refs.headPortrait.click()}}},[t._v("上传头像")]),a("input",{ref:"headPortrait",staticStyle:{display:"none"},attrs:{type:"file",name:"fileUpload"},on:{change:function(e){return t.uploadPhoto(e)}}})]),a("el-form-item",{staticClass:"mt-5",attrs:{label:"团队名称："}},[a("el-input",{model:{value:t.createTeamForm.name,callback:function(e){t.$set(t.createTeamForm,"name",e)},expression:"createTeamForm.name"}})],1),a("el-form-item",{attrs:{label:"团队人数："}},[t.projectInfo.minCount&&t.projectInfo.maxCount?a("span",[t._v(t._s(t.projectInfo.minCount)+"-"+t._s(t.projectInfo.maxCount)+"人")]):t._e()])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{width:"198px"},attrs:{type:"primary"},on:{click:t.createTeamSave}},[t._v("保存")])],1)])],1)},r=[],i=a("10df"),l=a("c80e"),s=a("d148"),m={components:{Header:i["a"],ProjectTitle:l["a"],TeamTab:s["a"]},name:"app",mounted(){this.myJoinType=parseInt(localStorage.getItem("myJoinType")),this.myJoinStatus=parseInt(localStorage.getItem("myJoinStatus")),this.loadData()},data(){return{projectInfo:{},createTeamDialogVisible:!1,createTeamForm:{logoUrl:"../../assets/img/default-head.png",name:""},searchKey:"",tabData:[{name:"选择项目",url:"course-detail.html"},{name:"组队",url:"team-search.html"},{name:"任务裁剪",url:""},{name:"人员管理",url:""}],teamInfo:{},teamData:[],myJoinType:"",myJoinStatus:""}},methods:{goBack(){window.location="team-search.html"},loadData(){this.loadTeamInfo(),this.loadProjectInfo()},loadTeamInfo(){let t=this,e=localStorage.getItem("teamId");this.$http.post("/teambuild/queryteaminfoformember",{teamId:e},e=>{e.success&&(t.teamInfo=e.data)})},loadProjectInfo(){let t=this,e=localStorage.getItem("projectId"),a=localStorage.getItem("courseId");this.$http.post("/teambuild/queryprojectinfo",{projectId:e,courseId:a},e=>{e.success&&(t.projectInfo=e.data,t.projectInfo.courseName=localStorage.getItem("courseName"))})},createTeam(){this.createTeamDialogVisible=!this.createTeamDialogVisible},createTeamSave(){let t=this,e=localStorage.getItem("projectId"),a=localStorage.getItem("courseId"),o=localStorage.getItem("grade");this.$http.post("/teambuild/buildteam",{logoUrl:this.createTeamForm.logoUrl,teamName:this.createTeamForm.name,courseId:a,projectId:e,grade:o},e=>{e.success&&(t.createTeamDialogVisible=!1,window.location="team-my.html")})},applyJoin(t){let e=this;this.$http.post("/teambuild/applyjointeam",{teamId:t},t=>{t.success&&(e.$alert("已提交申请！","提示",{confirmButtonText:"确定"}),e.myJoinStatus=0,e.myJoinType=1,localStorage.setItem("myJoinStatus",0),localStorage.setItem("myJoinType",1),e.loadData())})},uploadPhoto(t){let e=this,a=t.target.files[0],o=new FormData;o.append("file",a),this.$http.uploadFile("/teambuild/uploadimgforteam",o,t=>{t.success&&(e.$message("上传成功"),e.createTeamForm.logoUrl=t.data)})},goTeam(t){localStorage.setItem("teamId",t),window.location="team-view.html"},handleInvite(t,e){let a=this,o=localStorage.getItem("courseId"),n=localStorage.getItem("projectId");a.$http.post("/teambuild/agreerefuseinvitemember",{teamId:t,joinStatus:e},r=>{r.success&&(1===e?(a.$alert("已接受邀请！","提示",{confirmButtonText:"确定"}),localStorage.setItem("myJoinStatus",parseInt(e)),a.myJoinStatus=1,a.loadData()):(a.$alert("已拒绝邀请！","提示",{confirmButtonText:"确定"}),a.$http.post("/campuspage/querycourseprojectlist",{courseId:o},e=>{if(e.success)for(var o=0;o<e.data.length;o++)if(parseInt(n)===e.data[o].projectId)if(e.data[o].teamId===t||0===e.data[o].teamId)window.location="team-search.html";else{let t=e.data[o].teamId;a.$http.post("/teambuild/teamIdentityInfo",{teamId:t},e=>{localStorage.setItem("teamId",t),localStorage.setItem("myJoinStatus",e.data.joinStatus),localStorage.setItem("myJoinType",e.data.joinType),a.myJoinStatus=e.data.joinStatus,a.myJoinType=e.data.joinType,a.loadTeamInfo()})}})))})},deleteMe(){let t=this;this.$confirm("是否退出团队?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.$http.post("/teambuild/deleteteambuildmember",{teamId:t.teamInfo.teamId,userCode:t.teamInfo.userCode,teamRole:"0"},e=>{e.success&&(t.$message("退出成功！"),window.location="team-search.html")})})}}},c=m,u=(a("8a0e"),a("2877")),d=Object(u["a"])(c,n,r,!1,null,"334c5564",null),p=d.exports,f=(a("7378"),a("16b4"),a("346c"),a("1e3b"),a("3a10"),a("87c5"),a("0cb1"),a("4dcb"),a("751a"));o["default"].prototype.$http=f["a"],new o["default"]({render:t=>t(p)}).$mount("#app")}});
//# sourceMappingURL=team-view.b1eb93a9.js.map